"""
ARQUITECTURA RADICAL SIMPLIFICADA - Diagrama Visual
====================================================

FILOSOFÃA: "Clases vacÃ­as + Relleno de datos + Aplicar maquinaria"


ESTRUCTURA DE ARCHIVOS:
========================

RTD_Calibration/
â”œâ”€â”€ src/
â”‚   â”œâ”€â”€ sensor.py          # DATA CLASS (20 lÃ­neas)
â”‚   â”œâ”€â”€ run.py             # DATA CLASS (20 lÃ­neas)
â”‚   â”œâ”€â”€ calibration_set.py # DATA CLASS (30 lÃ­neas)
â”‚   â”œâ”€â”€ tree.py            # ESTRUCTURA + RELACIONES (80 lÃ­neas)
â”‚   â””â”€â”€ utils.py           # TODA LA MAQUINARIA (500+ lÃ­neas)
â”œâ”€â”€ main.py                # ORQUESTACIÃ“N (flujo principal)
â””â”€â”€ config/
    â””â”€â”€ config.yml         # ConfiguraciÃ³n


DIAGRAMA DE CLASES:
===================

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    main.py                              â”‚
â”‚              (ORQUESTACIÃ“N DEL FLUJO)                   â”‚
â”‚                                                         â”‚
â”‚  1. Tree(config) â†’ estructura vacÃ­a                     â”‚
â”‚  2. Cargar runs desde logfile                          â”‚
â”‚  3. utils.calculate_run_offsets() â†’ llenar Run.offsets â”‚
â”‚  4. utils.calculate_calibset_mean_offsets()            â”‚
â”‚  5. utils.calculate_tree_calibration_constants()       â”‚
â”‚  6. utils.export_results()                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
              â”‚ usa
              â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    utils.py                              â”‚
â”‚               (TODA LA MAQUINARIA)                       â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                          â”‚
â”‚  CARGA DE DATOS:                                         â”‚
â”‚  â€¢ load_run_data()                                       â”‚
â”‚  â€¢ get_run_metadata_from_logfile()                       â”‚
â”‚                                                          â”‚
â”‚  CÃLCULOS DE RUN:                                        â”‚
â”‚  â€¢ calculate_run_offsets()                               â”‚
â”‚                                                          â”‚
â”‚  CÃLCULOS DE CALIBSET:                                   â”‚
â”‚  â€¢ calculate_calibset_mean_offsets()                     â”‚
â”‚                                                          â”‚
â”‚  CONSTRUCCIÃ“N DE ESTRUCTURA:                             â”‚
â”‚  â€¢ initialize_calibset_from_config()                     â”‚
â”‚  â€¢ derive_parent_child_relations()                       â”‚
â”‚                                                          â”‚
â”‚  CÃLCULOS GLOBALES (TREE):                               â”‚
â”‚  â€¢ find_paths_between_sensors()                          â”‚
â”‚  â€¢ calculate_offset_along_path()                         â”‚
â”‚  â€¢ weighted_average_of_paths()                           â”‚
â”‚  â€¢ calculate_tree_calibration_constants() â† PRINCIPAL   â”‚
â”‚                                                          â”‚
â”‚  EXPORTACIÃ“N:                                            â”‚
â”‚  â€¢ export_calibration_results()                          â”‚
â”‚                                                          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
              â”‚ opera sobre
              â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                      Tree                               â”‚
â”‚              (ESTRUCTURA + RELACIONES)                  â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ DATA:                                                   â”‚
â”‚  - sets: Dict[int, CalibrationSet]                      â”‚
â”‚  - parent_child_relations: Dict[int, List[int]]         â”‚
â”‚  - sets_by_round: Dict[int, List[int]]                  â”‚
â”‚                                                         â”‚
â”‚ MÃ‰TODOS:                                                â”‚
â”‚  - _build_empty_structure()    # Crea sets vacÃ­os      â”‚
â”‚  - _derive_relations()         # Deriva parent-child   â”‚
â”‚  - print_structure()           # Imprime Ã¡rbol         â”‚
â”‚  - get_calibset()              # Accessor              â”‚
â”‚  - add_run_to_set()            # AÃ±ade run a set       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
              â”‚ contiene
              â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                  CalibrationSet                         â”‚
â”‚                   (DATA CLASS)                          â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ DATA:                                                   â”‚
â”‚  - set_number: int                                      â”‚
â”‚  - round: int                                           â”‚
â”‚  - parent_set: Optional[int]                            â”‚
â”‚  - sensors: List[Sensor]                                â”‚
â”‚  - reference_sensors: List[Sensor]                      â”‚
â”‚  - runs: List[Run]                                      â”‚
â”‚  - mean_offsets: Dict[int, float]  # Media de runs     â”‚
â”‚  - offset_errors: Dict[int, float]  # Desv. estÃ¡ndar   â”‚
â”‚                                                         â”‚
â”‚ MÃ‰TODOS:                                                â”‚
â”‚  - __repr__()  # Solo representaciÃ³n                   â”‚
â”‚                                                         â”‚
â”‚ NO TIENE:                                               â”‚
â”‚  - calibration_constants  â† Se calculan en Tree        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
              â”‚ contiene
              â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
              â–¼                  â–¼                  â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚      Sensor       â”‚  â”‚      Sensor       â”‚  â”‚       Run         â”‚
â”‚   (DATA CLASS)    â”‚  â”‚   (DATA CLASS)    â”‚  â”‚   (DATA CLASS)    â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ - id: int         â”‚  â”‚ - id: int         â”‚  â”‚ - filename: str   â”‚
â”‚ - calibration_    â”‚  â”‚ - calibration_    â”‚  â”‚ - temperature_    â”‚
â”‚   constant: float â”‚  â”‚   constant: float â”‚  â”‚   data: DataFrame â”‚
â”‚                   â”‚  â”‚                   â”‚  â”‚ - sensor_ids: []  â”‚
â”‚ MÃ‰TODOS:          â”‚  â”‚ MÃ‰TODOS:          â”‚  â”‚ - is_valid: bool  â”‚
â”‚ - __repr__()      â”‚  â”‚ - __repr__()      â”‚  â”‚ - offsets: dict   â”‚
â”‚ - __eq__()        â”‚  â”‚ - __eq__()        â”‚  â”‚                   â”‚
â”‚ - __hash__()      â”‚  â”‚ - __hash__()      â”‚  â”‚ MÃ‰TODOS:          â”‚
â”‚                   â”‚  â”‚                   â”‚  â”‚ - __repr__()      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
    (12 por set)         (2 refs por set)        (mÃºltiples por set)


FLUJO DE DATOS:
===============

PASO 1: ESTRUCTURA VACÃA
-------------------------
config.yml â”€â”€â†’ Tree.__init__() 
           â””â”€â”€â†’ Tree._build_empty_structure()
               â””â”€â”€â†’ utils.initialize_calibset_from_config()
                   â””â”€â”€â†’ CalibrationSet (vacÃ­o)
                       â””â”€â”€â†’ [Sensor Ã— 12] (vacÃ­os, sin constantes)


PASO 2: CARGAR RUNS
--------------------
logfile.csv â”€â”€â†’ main.py itera filas
            â””â”€â”€â†’ Run(filename)  # Crea objeto vacÃ­o
                â””â”€â”€â†’ utils.load_run_data(run) # Llena temperature_data
                    â””â”€â”€â†’ utils.calculate_run_offsets(run, ref_id)
                        â””â”€â”€â†’ run.offsets = {48060: 0.023, ...}
                            â””â”€â”€â†’ tree.add_run_to_set(run, set_number)


PASO 3: MEDIA DE OFFSETS POR SET
---------------------------------
tree.sets â”€â”€â†’ para cada CalibrationSet
          â””â”€â”€â†’ utils.calculate_calibset_mean_offsets(calib_set)
              â””â”€â”€â†’ calib_set.mean_offsets = media de todos los runs
              â””â”€â”€â†’ calib_set.offset_errors = desviaciÃ³n estÃ¡ndar


PASO 4: CONSTANTES FINALES (MAQUINARIA PESADA)
-----------------------------------------------
tree â”€â”€â†’ utils.calculate_tree_calibration_constants(tree, ref_set=57)
     â”‚
     â”œâ”€â”€â†’ Para cada sensor:
     â”‚    â”œâ”€â”€â†’ utils.find_paths_to_absolute_reference(sensor, 57)
     â”‚    â”‚    â””â”€â”€â†’ [camino1, camino2, camino3, ...]
     â”‚    â”‚
     â”‚    â”œâ”€â”€â†’ Para cada camino:
     â”‚    â”‚    â””â”€â”€â†’ utils.calculate_offset_along_path(camino)
     â”‚    â”‚         â””â”€â”€â†’ (offset, error)
     â”‚    â”‚
     â”‚    â””â”€â”€â†’ utils.weighted_average_of_paths(offsets, errors)
     â”‚         â””â”€â”€â†’ (constante_final, error_final)
     â”‚
     â””â”€â”€â†’ Actualiza sensor.calibration_constant


PASO 5: EXPORTAR
-----------------
tree â”€â”€â†’ utils.export_calibration_results(tree, "results.csv")
     â””â”€â”€â†’ CSV con constantes finales


RESPONSABILIDADES:
==================

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ COMPONENTE       â”‚ RESPONSABILIDAD                             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ Sensor           â”‚ â€¢ Almacenar ID                              â”‚
â”‚ (DATA CLASS)     â”‚ â€¢ Almacenar constante                       â”‚
â”‚                  â”‚ â€¢ [NO] Calcular nada                        â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ Run              â”‚ â€¢ Almacenar filename                        â”‚
â”‚ (DATA CLASS)     â”‚ â€¢ Almacenar datos de temperatura (crudos)   â”‚
â”‚                  â”‚ â€¢ Almacenar offsets (calculados por utils)  â”‚
â”‚                  â”‚ â€¢ [NO] Entender de sets                     â”‚
â”‚                  â”‚ â€¢ [NO] Calcular offsets (lo hace utils)    â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ CalibrationSet   â”‚ â€¢ Agrupar 12 sensores                       â”‚
â”‚ (DATA CLASS)     â”‚ â€¢ Agrupar mÃºltiples runs                    â”‚
â”‚                  â”‚ â€¢ Almacenar mean_offsets (media simple)     â”‚
â”‚                  â”‚ â€¢ [NO] Calcular constantes finales          â”‚
â”‚                  â”‚ â€¢ [NO] Referenciar a set absoluto           â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ Tree             â”‚ â€¢ Crear estructura desde config.yml         â”‚
â”‚ (ESTRUCTURA)     â”‚ â€¢ Derivar relaciones parent-child           â”‚
â”‚                  â”‚ â€¢ Clasificar por rondas                     â”‚
â”‚                  â”‚ â€¢ Imprimir estructura clara                 â”‚
â”‚                  â”‚ â€¢ [NO] Calcular constantes (lo hace utils)  â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ utils.py         â”‚ â€¢ Cargar datos de archivos                  â”‚
â”‚ (MAQUINARIA)     â”‚ â€¢ Calcular offsets de runs                  â”‚
â”‚                  â”‚ â€¢ Calcular medias por set                   â”‚
â”‚                  â”‚ â€¢ Encontrar caminos en Ã¡rbol                â”‚
â”‚                  â”‚ â€¢ Calcular constantes finales               â”‚
â”‚                  â”‚ â€¢ Media ponderada de caminos                â”‚
â”‚                  â”‚ â€¢ Exportar resultados                       â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ main.py          â”‚ â€¢ Orquestar flujo completo                  â”‚
â”‚ (ORQUESTACIÃ“N)   â”‚ â€¢ Llamar funciones en orden correcto        â”‚
â”‚                  â”‚ â€¢ Coordinar entrada/salida                  â”‚
â”‚                  â”‚ â€¢ Logs y mensajes informativos              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜


COMPARACIÃ“N: ANTES vs DESPUÃ‰S
==============================

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ ASPECTO            â”‚ ANTES               â”‚ DESPUÃ‰S             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ Run                â”‚ 243 lÃ­neas          â”‚ 20 lÃ­neas           â”‚
â”‚                    â”‚ Entiende de sets    â”‚ Solo datos          â”‚
â”‚                    â”‚ Calcula offsets     â”‚ No calcula          â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ Set                â”‚ 327 lÃ­neas          â”‚ 30 lÃ­neas           â”‚
â”‚                    â”‚ LÃ³gica compleja     â”‚ Solo datos          â”‚
â”‚                    â”‚ MÃºltiples mÃ©todos   â”‚ Sin mÃ©todos         â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ Tree               â”‚ 1342 lÃ­neas         â”‚ 80 lÃ­neas           â”‚
â”‚                    â”‚ Hace cÃ¡lculos       â”‚ Solo estructura     â”‚
â”‚                    â”‚ LÃ³gica mezclada     â”‚ Relaciones claras   â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ utils.py           â”‚ Funciones bÃ¡sicas   â”‚ 500+ lÃ­neas         â”‚
â”‚                    â”‚ Poco organizado     â”‚ Toda la maquinaria  â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ main.py            â”‚ No existe           â”‚ Flujo claro         â”‚
â”‚                    â”‚                     â”‚ Documentado         â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ TOTAL CLASES       â”‚ ~2000 lÃ­neas        â”‚ ~150 lÃ­neas         â”‚
â”‚ TOTAL MAQUINARIA   â”‚ Dispersa            â”‚ 500 lÃ­neas utils.py â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜


VENTAJAS CLAVE:
===============

âœ… Clases son DATA CLASSES puras (muy cortas)
âœ… Toda la lÃ³gica en utils.py (testeable)
âœ… Run NO entiende de sets (feedback del tutor)
âœ… Tree conoce relaciones (feedback del tutor)
âœ… CalibSet NO calcula constantes finales (feedback del tutor)
âœ… main.py orquesta claramente el flujo
âœ… FÃ¡cil de explicar al tutor
âœ… FÃ¡cil de mantener y extender
âœ… Testeable (funciones puras en utils)


EJEMPLO DE USO:
===============

# main.py
config = load_config()
tree = Tree(config)  # Estructura vacÃ­a

tree.print_structure()  # â† IMPRIME ÃRBOL CLARO DESDE EL INICIO
# Output:
# ============================================================
# ESTRUCTURA DEL ÃRBOL DE CALIBRACIÃ“N
# ============================================================
# 
# ğŸ“Š RONDA 1: 45 sets
#   Set  3: 12 sensores | Refs: [48176, 48177] | Raised: [48203, 48479] | Parents: []
#   Set  4: 12 sensores | Refs: [48176, 48177] | Raised: [48484, 48491] | Parents: []
#   ...
# 
# ğŸ“Š RONDA 2: 8 sets
#   Set 49: 12 sensores | Refs: [48176, 48177] | Raised: [...] | Parents: [3, 4, 5]
#   ...
# 
# ğŸ“Š RONDA 3: 7 sets
#   Set 57: 12 sensores | Refs: [...] | Raised: [] | Parents: [49, 50, 51]
# ============================================================

# Cargar datos
for row in logfile:
    run = Run(row['filename'])
    run = utils.load_run_data(run)
    run.offsets = utils.calculate_run_offsets(run, ref_id)
    tree.add_run_to_set(run, set_number)

# Calcular medias por set
for calib_set in tree.sets.values():
    utils.calculate_calibset_mean_offsets(calib_set)

# Calcular constantes finales (MAQUINARIA PESADA)
utils.calculate_tree_calibration_constants(tree, ref_set=57)

# Exportar
utils.export_calibration_results(tree, "results.csv")
"""
